## 📱 FreStyleとは

## 🎯 ターゲットユーザー

**新卒ITエンジニアのためのビジネスコミュニケーション練習アプリ**

- **顧客折衝**: 障害報告、要件変更の影響説明、見積もり交渉など、顧客との難しい場面を想定したケーススタディで学べます
- **シニアエンジニアとの対話**: 設計レビューでの意見対立、コードレビューのフィードバック対応、技術負債の改善提案など、経験豊富なエンジニアとのコミュニケーションスキルを磨けます
- **実践的なシナリオ**: AIがロールプレイ相手となり、実務で遭遇する12種類のビジネスシーンを体験できます
- **5軸評価 + IT新卒向けサブ基準**: 論理的構成力（報連相の構造化）、配慮表現（敬語の正確さ）、要約力（技術説明の平易化）、提案力（エスカレーション判断力）、質問・傾聴力（要件確認の網羅性）で評価

技術スキルだけでなく、ビジネスコミュニケーション能力も身につけたい新卒エンジニアを支援します。

---

## 🌐 デプロイURL（料金の関係上サービスを停止する可能性があります）

👉 [https://normanblog.com](https://normanblog.com)

---

## 🎥 Demo（変更前）

👉 [デモ動画](https://myapp-demo-videos.s3.ap-northeast-1.amazonaws.com/Fre-Style-demo.mp4)

---

## 🧰 使用技術

<h3>Frontend</h3>
<a href="https://skillicons.dev">
  <img src="https://skillicons.dev/icons?i=react,ts,tailwind,vite&theme=light" alt="Frontend">
</a>

<h3>Backend</h3>
<a href="https://skillicons.dev">
  <img src="https://skillicons.dev/icons?i=java,spring,gradle&theme=light" alt="Backend">
</a>

<h3>Infrastructure</h3>
<a href="https://skillicons.dev">
  <img src="https://skillicons.dev/icons?i=aws,cloudflare,docker&theme=light" alt="Infrastructure">
</a>

<h3>Database</h3>
<a href="https://skillicons.dev">
  <img src="https://skillicons.dev/icons?i=mysql,dynamodb&theme=light" alt="Database">
</a>

<h3>CI/CD</h3>
<a href="https://skillicons.dev">
  <img src="https://skillicons.dev/icons?i=githubactions&theme=light" alt="CI/CD">
</a>

### AWS サービス詳細

| カテゴリ | サービス |
|---------|----------|
| **Compute** | ECS (Fargate), Lambda |
| **Networking** | API Gateway, Route53, CloudFront, ALB |
| **Database** | RDS (MariaDB), DynamoDB |
| **Storage** | S3 |
| **Auth** | Cognito |

---

## ⚙️ 主な機能
- ユーザー登録・ログイン（JWT 認証 / OIDC）
- ユーザー同士のリアルタイムチャット
- 未読メッセージカウント・既読管理（リアルタイム通知対応）
- AI アシスタントとのチャット（ビジネスコミュニケーション5軸フィードバック対応）
  - **IT新卒エンジニア向けサブ基準**：報連相の構造化・敬語の正確さ・技術説明の平易化・エスカレーション判断力・要件確認の網羅性
- シーン別フィードバックモード（会議/1on1/メール/プレゼン/商談/**コードレビュー**/**障害対応**/**日報・週報** の全8シーン）
- メッセージ言い換え提案（フォーマル版/ソフト版/簡潔版/**質問型**/**提案型** の全5パターン）
- コミュニケーションスコアカード（5軸スコア数値化・棒グラフ可視化・総合スコア表示）
  - **スコアレベルラベル**：総合スコアに応じたレベル表示（優秀/実務/基礎）・色分けプログレスバー・低スコア軸の改善ヒント
  - **スコア履歴ページ**：セッション単位の履歴一覧表示・スコア推移グラフ・前回比変動表示・セッション種別フィルタ（練習/フリー）
- ビジネスシナリオ練習モード（AIロールプレイ・ITエンジニア向け12シナリオ・3カテゴリ対応）
  - **カテゴリ別フィルタリング**：顧客折衝・シニア/上司・チーム内のタブ切り替えで絞り込み
  - **練習終了時スコアリング**：シナリオ固有の評価軸でスコア自動算出
  - **難易度・所要時間表示**：各シナリオに色分け難易度バッジ・説明テキスト・所要時間目安
- シーン別フィードバックモード（全8シーン・カテゴリ分類・新卒向けおすすめ表示・利用例付き）
- メッセージ言い換え提案（全5パターン・利用シーンヒント付き・コピーフィードバック表示）
- ホームページダッシュボード（未読バッジ・最新スコア・新規ユーザー向けおすすめアクション）
- Notion風ミニマルUIデザイン（ニュートラルグレー配色・永続サイドバーナビゲーション・未読バッジ・セカンダリパネル・モバイルオーバーレイドロワー）
- パフォーマンス計測・可視化（Micrometer + CloudWatch メトリクス・AOP処理時間計測）
- Docker Compose によるローカル開発環境（MariaDB 11 + Spring Boot）
- プロフィール編集
- Google ログイン
- GitHub Actions による自動デプロイ（S3同期 + CloudFrontキャッシュ自動無効化）
- **練習結果サマリー**：練習終了後に強み・課題をハイライト表示、改善アドバイス付き
- **弱点ベースのおすすめ練習**：スコア履歴から弱点軸を特定し、おすすめ練習シナリオを提示
- **メッセージ送信状態表示**：送信中インジケーター・入力欄無効化で操作フィードバック向上
- **チャット内メッセージ検索**：キーワード検索・マッチ件数表示・検索クリア機能
- **練習ストリーク・達成バッジ**：連続練習日数カウント・4種類の達成バッジ（初回/3日/7日/10回）
- **グローバルエラーバウンダリー**：予期せぬエラー時のフレンドリーUI・再試行ボタン
- **スキルレーダーチャート**：SVGベースの5軸レーダーチャートでスキルバランスを可視化
- **お気に入りフレーズ集**：言い換え提案をLocalStorageに保存・一覧閲覧・削除管理
- **練習タイマー**：練習セッション中の経過時間をリアルタイム表示
- **日次学習目標**：1日の練習目標設定・プログレスバー・達成メッセージ表示
- **セッションメモ**：AIフィードバック後の振り返りメモを記録・閲覧
- **ダッシュボードインサイト**：総練習回数・平均スコア・練習日数を一覧表示
- **練習シナリオブックマーク**：よく使うシナリオをブックマーク保存・フィルター表示
- **週間学習レポート**：今週の練習回数・平均スコア・先週比較・曜日別練習状況
- **コミュニケーションTipsカード**：日替わりで14種類のビジネスコミュニケーションTipsを表示（メール/会議/報連相/チャット）
- **直近セッションカード**：最新3件のセッションをスコア色分け（緑/黄/赤）で表示
- **スコアランクバッジ**：S/A/B/C/Dランクでスコアレベルを視覚化（エキスパート〜入門の5段階）
- **練習リマインダーカード**：最後の練習からの経過日数に応じた励ましメッセージ表示
- **スコア統計サマリー**：総セッション数・平均スコア・最高スコアをグリッド表示
- **スキル別マイルストーンカード**：各スキル軸の到達レベル（入門〜エキスパート）をプログレスバーで表示
- **週間練習目標カード**：週5回の練習目標に対する達成率をプログレスバーで表示・達成度メッセージ
- **スキル別推移グラフ**：各スキル軸のスコア推移を折れ線グラフで可視化
- **練習カレンダー**：12週間のヒートマップ形式で練習頻度を可視化
- **スコア改善アドバイスカード**：スコア7未満の軸に具体的な改善アドバイスを表示・全軸高スコア時は祝福メッセージ
- **練習レベルシステム**：セッション数に応じたレベルアップ（Lv.1ビギナー〜Lv.8レジェンドの8段階）
- **デイリーチャレンジカード**：10種類のビジネスコミュニケーション課題を日替わり表示・難易度（初級/中級/上級）・カテゴリ分類
- **スコア比較カード**：初回と最新セッションのスコアを並べて比較・各軸の変動を色分け表示（成長/低下/維持）
- **セッション詳細モーダル**：スコア履歴のセッションをクリックすると各軸スコア・コメント詳細をモーダル表示
- **モチベーション名言カード**：ビジネスコミュニケーションに関する日替わり名言を10種類表示
- **達成バッジカード**：練習セッション数に応じた7段階の達成バッジ（ファーストステップ〜センチュリー）を表示
- **練習ストリークカレンダー**：過去28日間の練習日をカレンダー形式で表示・連続練習日数でモチベーション維持
- **スキル強弱サマリーカード**：最新セッションの強み（上位2軸）と弱み（下位2軸）を色分けで一目表示
- **最近のセッションメモカード**：LocalStorageに保存した振り返りメモの最新3件をダッシュボードに表示
- **次のステップ提案カード**：練習回数・平均スコアに応じた4段階のアクション提案をダッシュボードに表示
- **コミュニケーションスタイル判定カード**：5軸スコア平均から論理型/共感型/簡潔型/提案型/傾聴型を自動判定・スコア履歴ページに表示
- **目標スコア設定カード**：目標スコア（6.0〜10.0）をLocalStorageに保存・プログレスバー・達成/励ましメッセージ表示
- **学習パターン分析カード**：練習日の曜日分布から学習パターンを自動判定（平日集中型/週末集中型/毎日コツコツ型/不定期型）・曜日別頻度グラフ表示
- **スコア成長トレンドカード**：前半と後半のスコア平均を比較して成長傾向を判定（上昇/低下/安定）・最新スコア・トレンド別励ましメッセージ表示
- **スコア分布カード**：全セッションのスコアを4レンジ（9-10/7-8/4-6/1-3）に分類して横棒グラフで分布を表示・最頻レンジに応じた励ましメッセージ
- **お気に入り統計カード**：お気に入りフレーズの総数とパターン別（フォーマル/ソフト/簡潔/質問型/提案型）の内訳を横棒グラフで表示

### テスト品質
- **フロントエンド695テスト**：Vitest + React Testing Library
  - Repository層テスト（12リポジトリ・57テスト）
  - Hooks層テスト（24フック・193テスト）
  - Store層テスト（1スライス・5テスト）
  - UIコンポーネントテスト（64コンポーネント・329テスト）
  - ページコンポーネントテスト（16ページ・97テスト）
  - ユーティリティテスト（2モジュール・14テスト）
- **バックエンド**：JUnit 5 + Mockito

---

## 💡 Architecture Highlights（工夫した点）

### ① WebSocket と HTTP API の構成を用途別に完全分離
- **WebSocket**：API Gateway + Lambda + DynamoDB  
- **HTTP（Rest API）**：ECS（Fargate） + Spring Boot  

リアルタイム性と低コストを優先した WebSocket と、安定稼働・複雑処理に適した HTTP API を分離し、性能・コスト・可用性の最適化を実現。

### ② JWT（HttpOnly Cookie）× Spring Security の安全な認証設計
- JWT を HttpOnly Cookie に保存（XSS 対策）
- アクセストークンの有効期間を短くしリフレッシュトークンで再発行をする
- OIDC & JWK を活用した堅牢な認証フロー
- OIDC経由でも当該アプリ経由でも同一ユーザーとして認識

### ③ CloudFront によるグローバル最適化と HTTPS 化
- 高速配信（CDN）
- OIDC と組み合わせてセキュアなフロント構成
- Cognito/OIDCログインを使用しているのでHTTPSの必須になるので採用した

### ④ クリーンアーキテクチャの適用による保守性向上
**Phase 1-3リファクタリング完了** (2026年2月)

バックエンドコードをクリーンアーキテクチャに基づいて全面リファクタリングし、保守性・テスタビリティ・可読性を大幅に向上させました。

#### 実装内容
- **Mapper層**: DTO↔Entity変換を一箇所に集約（3クラス作成）
- **UseCase層**: ビジネスロジックをController層から分離（13クラス作成）
- **依存性逆転の原則**: Controller → UseCase → Repository の明確な依存関係を確立
- **単一責任の原則**: 各クラスの責務を明確化し、1クラス1責務を徹底

#### リファクタリング対象
- **Phase 1**: 練習モード機能（PracticeScenarioService → 3 UseCases）
- **Phase 2**: AI Chat機能（AiChatSessionService/AiChatMessageService → 10 UseCases）
- **Phase 3**: ScoreCard機能（ScoreCardService → 3 UseCases + Mapper）

#### 成果
- コード行数: **+1,849行追加 / -377行削除**
- テスタビリティ向上: モック化が容易な設計に
- 日本語コメント充実: 各クラスの役割・責務を明記

```
【アーキテクチャ構成】
Controller (Presentation層) ← HTTP/WebSocketリクエスト処理
  ↓ 依存
UseCase (Application層) ← ビジネスロジック実行
  ↓ 依存
Service (Domain層) ← ドメインロジック
  ↓ 依存
Repository (Infrastructure層) ← DB操作
```

---

## 🧠 苦労した点・学び
- WebSocket を ECS で保持するか、サーバーレスにするかの検討 → コスト/工数削減/レイテンシから Lambda + APIGW に決定
- Spring Security の JWT / JWK / Cookie 設計
- ALB の TLS Termination と ECS の Backend 構成

---

## ✔ 技術選定理由（HTTP API / ECS Fargate）

1. Docker 化した Spring Boot を安定稼働させるため
   - サーバープロビジョニング不要
   - OS 管理不要

2. ALB と連携した柔軟なルーティング
   - ホストベースルーティングで[BeStyle](https://normanblog.com)にも同じロードバランサーを使用をしコスト削減をした
   - ヘルスチェックをしておりSpring Bootのactuatorでヘルスチェックのエンドポイントにアクセス

3. Blue/Green デプロイ
   - CodeDeploy と連携
   - 新バージョンのヘルスチェック後に切替
   - 即時ロールバック可能

---

## ✔ 技術選定理由（WebSocket / サーバーレス構成）

1. コスト最適化（従量課金）  
   ECS 常時稼働より大幅に低コスト。

2. 低レイテンシ & シンプルな処理  
   Lambda → DynamoDB の最短経路。

3. サーバーレスで構成統一
   - フルマネージド
   - 自動スケーリング
   - 運用負荷最小

---

## 🏗️ AWSアーキテクチャ構成図

### AWS全体構成図（変更前）
![AWSアーキテクチャ構成図](./architecture/aws/image.png)

### ユーザー同士のチャット（変更前）
![ユーザー同士のチャット](./architecture/aws/aws-architecture-chat.png)

### AIとユーザーのチャット（変更前）
![AIとユーザーのチャット](./architecture/aws/aws-architecture-ai-chat.png)

### 変更後のAWSアーキテクチャー図
![AWSアーキテクチャ構成図](./architecture/aws/AWSアーキテクチャー設計修正後.png)

### なぜアーキテクチャーを変えたのか
1. AIへのフィードバックにユーザーがより自分の性格を把握できるように複雑なクエリを実行する必要があったのでDynamoDBではサービス層が複雑になるのでRDSに変更をした
2. Lambda + API Gatewayではトラフィック量が多くなったときに捌きにくいこと
3. 機能の拡張性を踏まえたらECS一本で使用したほうがSQSなどを設定したときに工数を割くことができる

---

## 🚀 今年の目標

### 技術・資格
- AWS SAP、CKA、CKAD
- GO言語でgRPC通信でサービス間接続

### 機能拡張
- 音声チャット
- Polly による AI 音声解答可能
- SageMakerを使用をしチャットの内容をクラスタリングで感情分析をすること
- 未読、既読、プッシュ通知機能の作成でSQS、SNSを使用をする
- チャット以外にもパーソナリティーが見えるシステムを作成する

---

## 🛠 ローカル開発環境セットアップ

### バックエンド（Docker Compose）

```bash
# 1. 環境変数ファイルを作成（.env.example をコピーして値を設定）
cp .env.example .env

# 2. MariaDB + Spring Boot を起動
docker compose up -d --build

# 3. 動作確認
docker compose ps          # コンテナ状態確認
docker compose logs api    # Spring Boot ログ確認
```

MariaDB 11 がコンテナとして起動し、Spring Boot 起動時に `schema.sql` でテーブルが自動作成されます。

### フロントエンド

```bash
# 1. リポジトリをクローンして frontend ディレクトリに移動
cd frontend

# 2. 依存パッケージをインストール
npm install

# 3. 動作確認
npm run dev

# 4. Tailwind CSS が動作しない場合
npm uninstall tailwindcss
npm install -D tailwindcss@バージョン指定
npx tailwindcss init -p
```

---

## 🗄️ 本番環境DBマイグレーション

本番環境（AWS RDS）にデプロイする際、スキーマの更新が必要な場合はマイグレーションSQLを実行してください。

### マイグレーション手順

```bash
# 1. AWS RDSに接続
mysql -h <RDS_ENDPOINT> -u <DB_USER> -p <DB_NAME>

# 2. マイグレーションSQLを実行
source FreStyle/migrations/001_add_practice_mode_support.sql;

# 3. 確認
SHOW COLUMNS FROM ai_chat_sessions;
SELECT COUNT(*) FROM practice_scenarios;
```

### マイグレーション一覧

| ファイル名 | 実行日 | 内容 |
|-----------|--------|------|
| `001_add_practice_mode_support.sql` | 2026-02-12 | 練習モード機能追加（`ai_chat_sessions` に `session_type`, `scenario_id` カラム追加、`practice_scenarios` テーブル作成、初期データ12件投入） |

**注意**: マイグレーションは冪等性があり、複数回実行しても安全です（`IF NOT EXISTS`, `INSERT IGNORE` を使用）。

---

## 📄 ライセンス

MIT License
